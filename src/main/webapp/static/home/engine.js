if(typeof this["dwr"]=="undefined"){dwr={}}(function(){dwr.engine={};dwr.engine.setErrorHandler=function(a){dwr.engine._errorHandler=a};dwr.engine.setWarningHandler=function(a){dwr.engine._warningHandler=a};dwr.engine.setTextHtmlHandler=function(a){dwr.engine._textHtmlHandler=a};dwr.engine.setTimeout=function(a){dwr.engine._timeout=a};dwr.engine.setPreHook=function(a){dwr.engine._preHook=a};dwr.engine.setPostHook=function(a){dwr.engine._postHook=a};dwr.engine.setHeaders=function(a){dwr.engine._headers=a};dwr.engine.setParameters=function(a){dwr.engine._parameters=a};dwr.engine.setOrdered=function(a){dwr.engine._ordered=a};dwr.engine.setAsync=function(a){dwr.engine._async=a};dwr.engine.setActiveReverseAjax=function(a){if(a){if(dwr.engine._activeReverseAjax)return;dwr.engine._activeReverseAjax=true;dwr.engine._poll()}else{if(dwr.engine._activeReverseAjax&&dwr.engine._pollReq)dwr.engine._pollReq.abort();dwr.engine._activeReverseAjax=false}};dwr.engine.setNotifyServerOnPageUnload=function(a){if(a==dwr.engine._isNotifyServerOnPageUnload)return;if(a){if(window.addEventListener)window.addEventListener("unload",dwr.engine._unloader,false);else if(window.attachEvent)window.attachEvent("onunload",dwr.engine._unloader)}else{if(window.removeEventListener)window.removeEventListener("unload",dwr.engine._unloader,false);else if(window.detachEvent)window.detachEvent("onunload",dwr.engine._unloader)}dwr.engine._isNotifyServerOnPageUnload=a};dwr.engine.defaultErrorHandler=function(a,b){dwr.engine._debug("Error: "+b.name+", "+b.message,true);if(a==null||a=="")alert("A server error has occurred.");else if(a.indexOf("0x80040111")!=-1)dwr.engine._debug(a);else alert(a)};dwr.engine.defaultWarningHandler=function(a,b){dwr.engine._debug(a)};dwr.engine.beginBatch=function(){if(dwr.engine._batch){dwr.engine._handleError(null,{name:"dwr.engine.batchBegun",message:"Batch already begun"});return}dwr.engine._batch=dwr.engine.batch.create()};dwr.engine.endBatch=function(a){var b=dwr.engine._batch;if(b==null){dwr.engine._handleError(null,{name:"dwr.engine.batchNotBegun",message:"No batch in progress"});return}dwr.engine._batch=null;if(b.map.callCount==0)return;if(a)dwr.engine.batch.merge(b,a);if(dwr.engine._ordered&&dwr.engine._batchesLength!=0){dwr.engine._batchQueue[dwr.engine._batchQueue.length]=b}else{dwr.engine.transport.send(b)}};dwr.engine.openInDownload=function(a){var b=document.createElement("div");document.body.appendChild(b);b.innerHTML="<iframe width='0' height='0' scrolling='no' frameborder='0' src='"+a+"'></iframe>"};dwr.engine._sessionCookieName="JSESSIONID";dwr.engine._allowGetForSafariButMakeForgeryEasier="false";dwr.engine._scriptTagProtection="throw 'allowScriptTagRemoting is false.';";dwr.engine._defaultPath="/dwr";dwr.engine._pollWithXhr="false";dwr.engine._ModePlainCall="/call/plaincall/";dwr.engine._ModePlainPoll="/call/plainpoll/";dwr.engine._ModeHtmlCall="/call/htmlcall/";dwr.engine._ModeHtmlPoll="/call/htmlpoll/";dwr.engine._scriptSessionId=null;dwr.engine._preHook=null;dwr.engine._postHook=null;dwr.engine._batches={};dwr.engine._batchesLength=0;dwr.engine._batchQueue=[];dwr.engine._ordered=true;dwr.engine._async=true;dwr.engine._batch=null;dwr.engine._timeout=0;dwr.engine._activeReverseAjax=false;dwr.engine._pollReq=null;dwr.engine._pollCometInterval=200;dwr.engine._pollRetries=0;dwr.engine._maxPollRetries=10;dwr.engine._retryIntervals=[2,5,10,60,300];dwr.engine._textHtmlHandler=null;dwr.engine._headers=null;dwr.engine._parameters=null;dwr.engine._nextBatchId=0;dwr.engine._propnames=["async","timeout","errorHandler","warningHandler","textHtmlHandler"];dwr.engine._partialResponseNo=0;dwr.engine._partialResponseYes=1;dwr.engine._partialResponseFlush=2;dwr.engine._isNotifyServerOnPageUnload=false;dwr.engine._getHttpSessionId=function(){var a=document.cookie.split(";");for(var b=0;b<a.length;b++){var c=a[b];while(c.charAt(0)==" ")c=c.substring(1,c.length);if(c.indexOf(dwr.engine._sessionCookieName+"=")==0){return c.substring(dwr.engine._sessionCookieName.length+1,c.length)}}return""};dwr.engine._errorHandler=dwr.engine.defaultErrorHandler;dwr.engine._warningHandler=dwr.engine.defaultWarningHandler;dwr.engine._postSeperator="\n";dwr.engine._defaultInterceptor=function(a){return a};dwr.engine._urlRewriteHandler=dwr.engine._defaultInterceptor;dwr.engine._contentRewriteHandler=dwr.engine._defaultInterceptor;dwr.engine._replyRewriteHandler=dwr.engine._defaultInterceptor;dwr.engine._unloader=function(){dwr.engine._debug("calling unloader for: "+dwr.engine._scriptSessionId);var a={map:{callCount:1,"c0-scriptName":"__System","c0-methodName":"pageUnloaded","c0-id":0},paramCount:0,isPoll:false,async:true,headers:{},preHooks:[],postHooks:[],timeout:dwr.engine._timeout,errorHandler:null,warningHandler:null,textHtmlHandler:null,path:dwr.engine._defaultPath,handlers:[{exceptionHandler:null,callback:null}]};dwr.engine.transport.send(a);dwr.engine.setNotifyServerOnPageUnload(false)};dwr.engine._execute=function(a,b,c,d){var e=false;if(dwr.engine._batch==null){dwr.engine.beginBatch();e=true}var f=[];for(var g=0;g<arguments.length-3;g++){f[g]=arguments[g+3]}var h=dwr.engine._batch;if(h.path==null){h.path=a}else{if(h.path!=a){dwr.engine._handleError(h,{name:"dwr.engine.multipleServlets",message:"Can't batch requests to multiple DWR Servlets."});return}}dwr.engine.batch.addCall(h,b,c,f);h.map.callCount++;if(e)dwr.engine.endBatch()};dwr.engine._poll=function(a){if(!dwr.engine._activeReverseAjax){return}var b=dwr.engine.batch.createPoll();dwr.engine.transport.send(b)};dwr.engine._pollErrorHandler=function(a,b){if(dwr.engine._pollRetries>dwr.engine._maxPollRetries){dwr.engine._activeReverseAjax=false;dwr.engine._debug("Reverse Ajax poll failed (retries="+dwr.engine._pollRetries+"). Giving Up: "+b.name+" : "+b.message);dwr.engine._debug("Giving up.");return}var c=dwr.engine._pollRetries;if(c>=dwr.engine._retryIntervals.length){c=dwr.engine._retryIntervals.length-1}dwr.engine._debug("Reverse Ajax poll failed (retries="+dwr.engine._pollRetries+"). Trying again in "+dwr.engine._retryIntervals[c]+"s: "+b.name+" : "+b.message);setTimeout("dwr.engine._poll()",1e3*dwr.engine._retryIntervals[c]);dwr.engine._pollRetries++};dwr.engine._eval=function(script){if(script==null){return null}if(script==""){dwr.engine._debug("Warning: blank script",true);return null}return eval(script)};dwr.engine._callPostHooks=function(a){if(a.postHooks){for(var b=0;b<a.postHooks.length;b++){a.postHooks[b]()}a.postHooks=null}};dwr.engine._handleError=function(a,b){if(typeof b=="string")b={name:"unknown",message:b};if(b.message==null)b.message="";if(b.name==null)b.name="unknown";if(a&&typeof a.errorHandler=="function")a.errorHandler(b.message,b);else if(dwr.engine._errorHandler)dwr.engine._errorHandler(b.message,b);if(a)dwr.engine.batch.remove(a)};dwr.engine._handleWarning=function(a,b){if(typeof b=="string")b={name:"unknown",message:b};if(b.message==null)b.message="";if(b.name==null)b.name="unknown";if(a&&typeof a.warningHandler=="function")a.warningHandler(b.message,b);else if(dwr.engine._warningHandler)dwr.engine._warningHandler(b.message,b);if(a)dwr.engine.batch.remove(a)};dwr.engine._debug=function(a,b){var c=false;try{if(window.console){if(b&&window.console.trace)window.console.trace();window.console.log(a);c=true}else if(window.Jaxer){Jaxer.Log.info(a)}else if(window.opera&&window.opera.postError){window.opera.postError(a);c=true}}catch(d){}if(!c){var e=document.getElementById("dwr-debug");if(e){var f=a+"<br/>"+e.innerHTML;if(f.length>2048)f=f.substring(0,2048);e.innerHTML=f}}};dwr.engine.remote={handleCallback:function(a,b,c){var d=dwr.engine._batches[a];if(d==null){dwr.engine._debug("Warning: batch == null in remoteHandleCallback for batchId="+a,true);return}try{var e=d.handlers[b];if(!e){dwr.engine._debug("Warning: Missing handlers. callId="+b,true)}else{d.handlers[b]=null;if(typeof e.callback=="function"){e.callback.call(e.callbackScope,c,e.callbackArgs)}}}catch(f){dwr.engine._handleError(d,f)}},handleException:function(a,b,c){var d=dwr.engine._batches[a];if(d==null){dwr.engine._debug("Warning: null batch in remoteHandleException",true);return}var e=d.handlers[b];d.handlers[b]=null;if(e==null){dwr.engine._debug("Warning: null handlers in remoteHandleException",true);return}if(c.message==undefined){c.message=""}if(typeof e.exceptionHandler=="function"){e.exceptionHandler.call(e.exceptionScope,c.message,c,e.exceptionArgs)}else if(typeof d.errorHandler=="function"){d.errorHandler(c.message,c)}},handleBatchException:function(a,b){var c=dwr.engine._receivedBatch==null&&b!=null;if(c){dwr.engine._receivedBatch=dwr.engine._batches[b]}if(a.message==undefined)a.message="";dwr.engine._handleError(dwr.engine._receivedBatch,a);if(c){dwr.engine._receivedBatch=null;dwr.engine.batch.remove(dwr.engine._batches[b])}},handleNewScriptSession:function(a){if(dwr.engine._scriptSessionId!=null){dwr.engine._debug("Server side script session id timed out. New session automatically created")}dwr.engine._scriptSessionId=a},handleNewWindowName:function(a){dwr.engine._debug("Setting new window name: "+a);if(window.name!=null&&window.name!=""){dwr.engine._debug("- Warning: This will override existing name of: "+window.name)}window.name=a},handleForeign:function(a,b){var c=window.open(null,a);if(c!=null){if(c.dwr!=null){c.dwr.engine._eval(b)}else{dwr.engine._debug("Found window, but DWR did not exist in it")}}else{dwr.engine._debug("Could not find window")}},pollCometDisabled:function(a,b){dwr.engine.setActiveReverseAjax(false);var c=dwr.engine._receivedBatch==null&&b!=null;if(c){dwr.engine._receivedBatch=dwr.engine._batches[b]}if(a.message==undefined){a.message=""}dwr.engine._handleError(dwr.engine._receivedBatch,a);if(c){dwr.engine._receivedBatch=null;dwr.engine.batch.remove(dwr.engine._batches[b])}}};dwr.engine.serialize={domDocument:["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","Msxml2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"],toDom:function(a){var b;if(window.DOMParser){var c=new DOMParser;b=c.parseFromString(a,"text/xml");if(!b.documentElement||b.documentElement.tagName=="parsererror"){var d=b.documentElement.firstChild.data;d+="\n"+b.documentElement.firstChild.nextSibling.firstChild.data;throw d}return b}else if(window.ActiveXObject){b=dwr.engine.util.newActiveXObject(dwr.engine.serialize.domDocument);b.loadXML(a);return b}else{var e=document.createElement("div");e.innerHTML=a;return e}},convert:function(a,b,c,d){if(c==null){a.map[d]="null:null";return}switch(typeof c){case"boolean":a.map[d]="boolean:"+c;break;case"number":a.map[d]="number:"+c;break;case"string":a.map[d]="string:"+encodeURIComponent(c);break;case"object":var e=dwr.engine.serialize.lookup(b,c,d);if(e){a.map[d]=e}else if(c instanceof String)a.map[d]="String:"+encodeURIComponent(c);else if(c instanceof Boolean)a.map[d]="Boolean:"+c;else if(c instanceof Number)a.map[d]="Number:"+c;else if(c instanceof Date)a.map[d]="Date:"+c.getTime();else if(c&&c.join)a.map[d]=dwr.engine.serialize.convertArray(a,b,c,d);else if(c&&c.tagName&&c.tagName.toLowerCase()=="input"&&c.type&&c.type.toLowerCase()=="file"){a.fileUpload=true;a.map[d]=c}else{if(c.nodeName&&c.nodeType){a.map[d]=dwr.engine.serialize.convertXml(a,b,c,d)}else{a.map[d]=dwr.engine.serialize.convertObject(a,b,c,d)}}break;case"function":break;default:dwr.engine._handleWarning(null,{name:"dwr.engine.unexpectedType",message:"Unexpected type: "+typeof c+", attempting default converter."});a.map[d]="default:"+c;break}},convertArray:function(a,b,c,d){var e="Array:[";for(var f=0;f<c.length;f++){if(f!=0)e+=",";a.paramCount++;var g="c"+dwr.engine._batch.map.callCount+"-e"+a.paramCount;dwr.engine.serialize.convert(a,b,c[f],g);e+="reference:";e+=g}e+="]";return e},convertObject:function(a,b,c,d){var e="Object_"+dwr.engine.serialize.getObjectClassName(c)+":{";var f;for(f in c){if(typeof c[f]!="function"){a.paramCount++;var g="c"+dwr.engine._batch.map.callCount+"-e"+a.paramCount;dwr.engine.serialize.convert(a,b,c[f],g);e+=encodeURIComponent(f)+":reference:"+g+", "}}if(e.substring(e.length-2)==", "){e=e.substring(0,e.length-2)}e+="}";return e},convertXml:function(a,b,c,d){var e;if(window.XMLSerializer)e=(new XMLSerializer).serializeToString(c);else if(c.toXml)e=c.toXml;else e=c.innerHTML;return"XML:"+encodeURIComponent(e)},lookup:function(a,b,c){var d;for(var e=0;e<a.length;e++){if(a[e].data==b){d=a[e];break}}if(d){return"reference:"+d.name}a.push({data:b,name:c});return null},errorClasses:{Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError},getObjectClassName:function(a){if(a&&a.constructor&&a.constructor.toString){var b=a.constructor.toString();var c=b.match(/function\s+(\w+)/);if(c&&c.length==2){return c[1]}}if(a&&a.constructor){for(var d in dwr.engine.serialize.errorClasses){if(a.constructor==dwr.engine.serialize.errorClasses[d])return d}}if(a){var b=Object.prototype.toString.call(a);var c=b.match(/\[object\s+(\w+)/);if(c&&c.length==2){return c[1]}}return"Object"}};dwr.engine.transport={send:function(a){dwr.engine.batch.prepareToSend(a);if(a.fileUpload){a.transport=dwr.engine.transport.iframe}else if(dwr.engine.isCrossDomain){a.transport=dwr.engine.transport.scriptTag}else{a.transport=dwr.engine.transport.xhr}a.transport.send(a)},remove:function(a){dwr.engine.transport.iframe.remove(a);dwr.engine.transport.xhr.remove(a)},abort:function(a){if(a&&!a.completed){clearInterval(a.interval);dwr.engine.batch.remove(a);if(a.req){a.req.abort()}dwr.engine.transport.remove(a);dwr.engine._handleError(a,{name:"dwr.engine.timeout",message:"Timeout"})}},xhr:{httpMethod:"POST",XMLHTTP:["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],send:function(a){if(a.isPoll){a.map.partialResponse=dwr.engine._partialResponseYes}if(a.isPoll&&dwr.engine._pollWithXhr=="true"){a.map.partialResponse=dwr.engine._partialResponseNo}if(a.isPoll&&dwr.engine.isIE){a.map.partialResponse=dwr.engine._partialResponseNo}if(window.XMLHttpRequest){a.req=new XMLHttpRequest}else if(window.ActiveXObject){a.req=dwr.engine.util.newActiveXObject(dwr.engine.transport.xhr.XMLHTTP)}if(a.async){a.req.onreadystatechange=function(){if(typeof dwr!="undefined")dwr.engine.transport.xhr.stateChange(a)}}if(a.isPoll){dwr.engine._pollReq=a.req;if(!document.all)a.req.batch=a}httpMethod=dwr.engine.transport.xhr.httpMethod;var b=navigator.userAgent.indexOf("Safari/");if(b>=0){var c=navigator.userAgent.substring(b+7);if(parseInt(c,10)<400){if(dwr.engine._allowGetForSafariButMakeForgeryEasier=="true"){httpMethod="GET"}else{dwr.engine._handleWarning(a,{name:"dwr.engine.oldSafari",message:"Safari GET support disabled. See getahead.org/dwr/server/servlet and allowGetForSafariButMakeForgeryEasier."})}}}a.mode=a.isPoll?dwr.engine._ModePlainPoll:dwr.engine._ModePlainCall;var d=dwr.engine.batch.constructRequest(a,httpMethod);try{a.req.open(httpMethod,d.url,a.async);try{for(var e in a.headers){var f=a.headers[e];if(typeof f=="string")a.req.setRequestHeader(e,f)}if(!a.headers["Content-Type"])a.req.setRequestHeader("Content-Type","text/plain")}catch(g){dwr.engine._handleWarning(a,g)}a.req.send(d.body);if(!a.async)dwr.engine.transport.xhr.stateChange(a)}catch(g){dwr.engine._handleError(a,g)}if(a.isPoll&&a.map.partialResponse==dwr.engine._partialResponseYes){dwr.engine.transport.xhr.checkCometPoll()}},stateChange:function(a){var b;if(a.completed){dwr.engine._debug("Error: _stateChange() with batch.completed");return}var c=a.req;try{if(c.readyState!=4)return}catch(d){dwr.engine._handleWarning(a,d);dwr.engine.batch.remove(a);return}try{var e=c.responseText;e=dwr.engine._replyRewriteHandler(e);var f=c.status;if(e==null||e==""){dwr.engine._handleWarning(a,{name:"dwr.engine.missingData",message:"No data received from server"})}else if(f!=200){dwr.engine._handleError(a,{name:"dwr.engine.http."+f,message:c.statusText})}else{var g=c.getResponseHeader("Content-Type");if(!g.match(/^text\/plain/)&&!g.match(/^text\/javascript/)){if(g.match(/^text\/html/)&&typeof a.textHtmlHandler=="function"){a.textHtmlHandler({status:f,responseText:e,contentType:g})}else{dwr.engine._handleWarning(a,{name:"dwr.engine.invalidMimeType",message:"Invalid content type: '"+g+"'"})}}else{if(a.isPoll&&a.map.partialResponse==dwr.engine._partialResponseYes){dwr.engine.transport.xhr.processCometResponse(e,a)}else{if(e.search("//#DWR")==-1){dwr.engine._handleWarning(a,{name:"dwr.engine.invalidReply",message:"Invalid reply from server"})}else{b=e}}}}}catch(d){dwr.engine._handleWarning(a,d)}dwr.engine._callPostHooks(a);dwr.engine._receivedBatch=a;if(b!=null)b=b.replace(dwr.engine._scriptTagProtection,"");dwr.engine._eval(b);dwr.engine._receivedBatch=null;dwr.engine.batch.validate(a);dwr.engine.batch.remove(a)},checkCometPoll:function(){if(dwr.engine._pollReq){var a=dwr.engine._pollReq;var b=a.responseText;if(b!=null){dwr.engine.transport.xhr.processCometResponse(b,a.batch)}}if(dwr.engine._pollReq){setTimeout("dwr.engine.transport.xhr.checkCometPoll()",dwr.engine._pollCometInterval)}},processCometResponse:function(a,b){if(b.charsProcessed==a.length)return;if(a.length==0){b.charsProcessed=0;return}var c=a.indexOf("//#DWR-START#",b.charsProcessed);if(c==-1){b.charsProcessed=a.length;return}var d=a.lastIndexOf("//#DWR-END#");if(d==-1){return}if(a.charCodeAt(d+11)==13&&a.charCodeAt(d+12)==10){b.charsProcessed=d+13}else{b.charsProcessed=d+11}var e=a.substring(c+13,d);try{dwr.engine._receivedBatch=b;dwr.engine._eval(e);dwr.engine._receivedBatch=null}catch(f){dwr.engine._handleError(b,f)}},remove:function(a){if(a.req){if(a.req==dwr.engine._pollReq)dwr.engine._pollReq=null;delete a.req}}},iframe:{send:function(a){if(a.fileUpload){a.httpMethod="POST";a.encType="multipart/form-data"}var b=dwr.engine.transport.iframe.getId(a);a.div=document.createElement("div");document.body.appendChild(a.div);a.div.innerHTML="<iframe src='javascript:void(0)' frameborder='0' style='width:0px;height:0px;border:0;' id='"+b+"' name='"+b+"' onload='dwr.engine.transport.iframe.loadingComplete("+a.map.batchId+");'></iframe>";a.document=document;dwr.engine.transport.iframe.beginLoader(a,b)},getId:function(a){return a.isPoll?"dwr-if-poll-"+a.map.batchId:"dwr-if-"+a.map["c0-id"]},beginLoader:function(a,b){a.iframe=a.document.getElementById(b);a.iframe.batch=a;a.mode=a.isPoll?dwr.engine._ModeHtmlPoll:dwr.engine._ModeHtmlCall;if(a.isPoll)dwr.engine._outstandingIFrames.push(a.iframe);var c=dwr.engine.batch.constructRequest(a,a.httpMethod);if(a.httpMethod=="GET"){a.iframe.setAttribute("src",c.url)}else{var d="<form id='dwr-form' action='"+c.url+"' target='"+b+"' style='display:none;' method='"+a.httpMethod+"'";if(a.encType)d+=" enctype='"+a.encType+"'";d+="></form>";var e=a.document.createElement("div");e.innerHTML=d;a.form=e.firstChild;for(var f in a.map){var g=a.map[f];if(typeof g!="function"){if(g.tagName&&g.tagName.toLowerCase()=="input"&&g.type&&g.type.toLowerCase()=="file"){var h=g.cloneNode(true);g.removeAttribute("id",f);g.setAttribute("name",f);g.parentNode.insertBefore(h,g);g.parentNode.removeChild(g);a.form.appendChild(g)}else{var i=a.document.createElement("input");i.setAttribute("type","hidden");i.setAttribute("name",f);i.setAttribute("value",g);a.form.appendChild(i)}}}a.document.body.appendChild(a.form);a.form.submit()}},loadingComplete:function(a){var b=dwr.engine._batches[a];if(b)dwr.engine.batch.validate(b)},remote:{beginIFrameResponse:function(a,b){if(a!=null)dwr.engine._receivedBatch=a.batch;dwr.engine._callPostHooks(dwr.engine._receivedBatch)},endIFrameResponse:function(a){dwr.engine.batch.remove(dwr.engine._receivedBatch);dwr.engine._receivedBatch=null}},remove:function(a){if(a.div){a.div.parentNode.removeChild(a.div)}if(a.iframe){a.iframe.parentNode.removeChild(a.iframe)}if(a.form){a.form.parentNode.removeChild(a.form)}}},scriptTag:{send:function(a){a.mode=a.isPoll?dwr.engine._ModePlainPoll:dwr.engine._ModePlainCall;var b=dwr.engine.batch.constructRequest(a,"GET");a.script=document.createElement("script");a.script.id="dwr-st-"+a.map["c0-id"];a.script.src=b.url;document.body.appendChild(a.script)}},htmlfile:{send:function(a){var b=dwr.engine.transport.iframe.getId(a);a.htmlfile=new window.ActiveXObject("htmlfile");a.htmlfile.open();a.htmlfile.write("<"+"html>");a.htmlfile.write("<div><iframe className='wibble' src='javascript:void(0)' id='"+b+"' name='"+b+"' onload='dwr.engine.transport.iframe.loadingComplete("+a.map.batchId+");'></iframe></div>");a.htmlfile.write("</"+"html>");a.htmlfile.close();a.htmlfile.parentWindow.dwr=dwr;a.document=a.htmlfile;dwr.engine.transport.iframe.beginLoader(a,b)}}};dwr.engine.batch={create:function(){var a={async:dwr.engine._async,charsProcessed:0,handlers:{},isPoll:false,map:{callCount:0,windowName:window.name},paramCount:0,preHooks:[],postHooks:[],timeout:dwr.engine._timeout,errorHandler:dwr.engine._errorHandler,warningHandler:dwr.engine._warningHandler,textHtmlHandler:dwr.engine._textHtmlHandler};if(dwr.engine._preHook){a.preHooks.push(dwr.engine._preHook)}if(dwr.engine._postHook){a.postHooks.push(dwr.engine._postHook)}dwr.engine.batch.populateHeadersAndParameters(a);return a},createPoll:function(){var a={async:true,charsProcessed:0,handlers:[{callback:function(a){dwr.engine._pollRetries=0;setTimeout("dwr.engine._poll()",a)}}],isPoll:true,map:{windowName:window.name},paramCount:0,path:dwr.engine._defaultPath,preHooks:[],postHooks:[],timeout:0,windowName:window.name,errorHandler:dwr.engine._pollErrorHandler,warningHandler:dwr.engine._pollErrorHandler,textHtmlHandler:dwr.engine._textHtmlHandler};dwr.engine.batch.populateHeadersAndParameters(a);return a},populateHeadersAndParameters:function(a){var b,c;a.headers={};if(dwr.engine._headers){for(b in dwr.engine._headers){c=dwr.engine._headers[b];if(typeof c!="function")a.headers[b]=c}}a.parameters={};if(dwr.engine._parameters){for(b in dwr.engine._parameters){c=dwr.engine._parameters[b];if(typeof c!="function")a.parameters[b]=c}}},addCall:function(a,b,c,d){var e;var f=d[d.length-1];if(typeof f=="function"||f==null)e={callback:d.pop()};else e=d.pop();dwr.engine.batch.merge(a,e);a.handlers[a.map.callCount]={exceptionHandler:e.exceptionHandler,exceptionArgs:e.exceptionArgs||e.args||null,exceptionScope:e.exceptionScope||e.scope||window,callback:e.callbackHandler||e.callback,callbackArgs:e.callbackArgs||e.args||null,callbackScope:e.callbackScope||e.scope||window};var g="c"+a.map.callCount+"-";a.map[g+"scriptName"]=b;a.map[g+"methodName"]=c;a.map[g+"id"]=a.map.callCount;var h=[];for(i=0;i<d.length;i++){dwr.engine.serialize.convert(a,h,d[i],g+"param"+i)}},merge:function(a,b){var c,d;for(var e=0;e<dwr.engine._propnames.length;e++){c=dwr.engine._propnames[e];if(b[c]!=null)a[c]=b[c]}if(b.preHook!=null)a.preHooks.unshift(b.preHook);if(b.postHook!=null)a.postHooks.push(b.postHook);if(b.headers){for(c in b.headers){d=b.headers[c];if(typeof d!="function")a.headers[c]=d}}if(b.parameters){for(c in b.parameters){d=b.parameters[c];if(typeof d!="function")a.map["p-"+c]=""+d}}},prepareToSend:function(a){a.map.batchId=dwr.engine._nextBatchId;dwr.engine._nextBatchId++;dwr.engine._batches[a.map.batchId]=a;dwr.engine._batchesLength++;a.completed=false;a.map.page=window.location.pathname+window.location.search;a.map.httpSessionId=dwr.engine._getHttpSessionId();a.map.scriptSessionId=dwr.engine._scriptSessionId;for(var b=0;b<a.preHooks.length;b++){a.preHooks[b]()}a.preHooks=null;if(a.timeout&&a.timeout!=0){a.interval=setInterval(function(){dwr.engine.transport.abort(a)},a.timeout)}},constructRequest:function(a,b){var c=[];c.push(a.path);c.push(a.mode);if(a.isPoll==true){c.push("ReverseAjax.dwr")}else if(a.map.callCount==1){c.push(a.map["c0-scriptName"]);c.push(".");c.push(a.map["c0-methodName"]);c.push(".dwr")}else{c.push("Multiple.");c.push(a.map.callCount);c.push(".dwr")}var d=location.href.match(/jsessionid=([^?]+)/);if(d!=null){c.push(";jsessionid=");c.push(d[1])}var e={};var f;if(b=="GET"){a.map.callCount=""+a.map.callCount;c.push("?");for(f in a.map){if(typeof a.map[f]!="function"){c.push(encodeURIComponent(f));c.push("=");c.push(encodeURIComponent(a.map[f]));c.push("&")}}c.pop();e.body=null}else{var g=[];for(f in a.map){if(typeof a.map[f]!="function"){g.push(f);g.push("=");g.push(a.map[f]);g.push(dwr.engine._postSeperator)}}e.body=dwr.engine._contentRewriteHandler(g.join(""))}e.url=dwr.engine._urlRewriteHandler(c.join(""));return e},validate:function(a){if(!a.completed){for(var b=0;b<a.map.callCount;b++){if(a.handlers[b]!=null){dwr.engine._handleWarning(a,{name:"dwr.engine.incompleteReply",message:"Incomplete reply from server"});break}}}},remove:function(a){if(!a){dwr.engine._debug("Warning: null batch in dwr.engine.batch.remove()",true);return}if(a.completed=="true"){dwr.engine._debug("Warning: Double complete",true);return}a.completed=true;dwr.engine.transport.remove(a);if(a.map&&(a.map.batchId||a.map.batchId==0)){delete dwr.engine._batches[a.map.batchId];dwr.engine._batchesLength--}if(dwr.engine._batchQueue.length!=0){var b=dwr.engine._batchQueue.shift();dwr.engine.transport.send(b)}}};dwr.engine.util={newActiveXObject:function(a){var b;for(var c=0;c<a.length;c++){try{b=new ActiveXObject(a[c]);break}catch(d){}}return b}};var userAgent=navigator.userAgent;var versionString=navigator.appVersion;var version=parseFloat(versionString);dwr.engine.isOpera=userAgent.indexOf("Opera")>=0?version:0;dwr.engine.isKhtml=versionString.indexOf("Konqueror")>=0||versionString.indexOf("Safari")>=0?version:0;dwr.engine.isSafari=versionString.indexOf("Safari")>=0?version:0;var geckoPos=userAgent.indexOf("Gecko");dwr.engine.isMozilla=geckoPos>=0&&!dwr.engine.isKhtml?version:0;dwr.engine.isFF=0;dwr.engine.isIE=0;try{if(dwr.engine.isMozilla){dwr.engine.isFF=parseFloat(userAgent.split("Firefox/")[1].split(" ")[0])}if(document.all&&!dwr.engine.isOpera){dwr.engine.isIE=parseFloat(versionString.split("MSIE ")[1].split(";")[0])}}catch(ex){}dwr.engine._execute(dwr.engine._defaultPath,"__System","pageLoaded",function(){dwr.engine._ordered=false});dwr.hub={publish:function(a,b){dwr.engine._execute(dwr.engine._defaultPath,"__System","publish",a,b,{})},subscribe:function(a,b,c,d){var e=""+dwr.hub._subscriptionId++;dwr.hub._subscriptions[e]={callback:b,scope:c,subscriberData:d};dwr.engine._execute(dwr.engine._defaultPath,"__System","subscribe",a,e,{});return e},_remotePublish:function(a,b){var c=dwr.hub._subscriptions[a];if(!c)return;c.callback.call(c.scope,b,c.subscriberData)},subscribe:function(a,b,c,d){var e=""+dwr.hub._subscriptionId++;dwr.hub._subscriptions[e]={callback:b,scope:c,subscriberData:d};dwr.engine._execute(dwr.engine._defaultPath,"__System","subscribe",a,e,{});return e},_subscriptionId:0,_subscriptions:{}}})()