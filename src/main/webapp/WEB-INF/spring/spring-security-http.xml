<?xml version="1.0" encoding="UTF-8"?>
<!--
 ! (c) Copyright 2005-2011 JAXIO, www.jaxio.com
 ! Source code generated by Celerio, a Jaxio product
 ! Want to use Celerio within your company? email us at info@jaxio.com
 ! Follow us on twitter: @springfuse
 ! Template pack-mvc-3:src/main/webapp/WEB-INF/spring/spring-security-http.p.vm.xml
-->
<beans:beans xmlns="http://www.springframework.org/schema/security" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:beans="http://www.springframework.org/schema/beans"
	xsi:schemaLocation="
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
		http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.0.xsd">
	<http use-expressions="true">
		<!-- User -->
		<intercept-url pattern="/app/logout*" access="isAuthenticated()" />
		<intercept-url pattern="/app/config/**" access="isAuthenticated()" />
                
                <intercept-url pattern="/dwr/interface/ProgramAjaxService.js" access="hasRole('ROLE_USER')" />
                <intercept-url pattern="/app/home/**" access="hasRole('ROLE_USER')" />
                <intercept-url pattern="/dwr/test/**" access="hasRole('ROLE_USER')" />
		<!-- Admin -->
		<intercept-url pattern="/app/domain/**" access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/app/admin/**" access="hasRole('ROLE_ADMIN')" />
		<!-- Anonymous -->
		<intercept-url pattern="/app/**" access="permitAll()" />

		<form-login 
			login-page="/login/" 
			login-processing-url="/app/logincheck" 
			default-target-url="/app/home/index" 
			always-use-default-target="false" 
			authentication-failure-url="/login/" />

		<logout
			logout-url="/app/logout" 
			logout-success-url="/" />

		<access-denied-handler 
			error-page="/app/login/accessdenied" />

		<remember-me user-service-ref="accountDetailsService" />

		<anonymous />
		<http-basic />
	</http>
</beans:beans>